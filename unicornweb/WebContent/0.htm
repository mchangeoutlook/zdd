<html>
<head>
<meta http-equiv="Content-Type"
	content="application/xhtml+xml; charset=utf-8" />
<meta name="viewport"
	content="width=device-width, minimum-scale=1.0, initial-scale=1.0, maximum-scale=1.0, user-scalable=no" />
<meta name="mobileoptimized" content="0" />
<title>Unicorn</title>
<script type="text/javascript" src="/cw/3rdjs/jquery-3.3.1.min.js"></script>
<script type="text/javascript">
	$(document).ready(function() {

		$.ajax({
			type : "POST",
			//enctype : 'multipart/form-data',
			url : "/unicornserver/uf",
			data : {"extraField":"asdfasdfa"},
			processData : false,
			contentType : false,
			cache : false,
			timeout : 600000,
			dataType:'json',
			success : function(data) {

				$("#result").text(data);
				console.log("SUCCESS : ", data);
				$("#btnSubmit").prop("disabled", false);

			},
			error : function(e) {

				$("#result").text(e.responseText);
				console.log("ERROR : ", e);
				$("#btnSubmit").prop("disabled", false);

			}
		});


		$("#btnSubmit").click(function(event) {

			//stop submit the form, we will post it manually.
			event.preventDefault();

			// Get form
			var form = $('#fileUploadForm')[0];

			// Create an FormData object 
			var data = new FormData(form);

			// If you want to add an extra field for the FormData
			data.append("CustomField", "This is some extra data, testing");

			// disabled the submit button
			$("#btnSubmit").prop("disabled", true);

			$.ajax({
				type : "POST",
				//enctype : 'multipart/form-data',
				url : "/unicornserver/uf",
				data : data,
				processData : false,
				contentType : false,
				cache : false,
				timeout : 600000,
				dataType:'json',
				success : function(data) {

					$("#result").text(data);
					console.log("SUCCESS : ", data);
					$("#btnSubmit").prop("disabled", false);

				},
				error : function(e) {

					$("#result").text(e.responseText);
					console.log("ERROR : ", e);
					$("#btnSubmit").prop("disabled", false);

				}
			});

		});

	});
</script>

</head>
<body>
	<form method="POST" enctype="multipart/form-data" id="fileUploadForm">
		<input type="text" name="extraField" /><br />
		<br /> <input type="file" name="files" /><br />
		<br /> <input type="file" name="files" /><br />
		<br /> <input type="submit" value="Submit" id="btnSubmit" />
	</form>
</body>
</html>
